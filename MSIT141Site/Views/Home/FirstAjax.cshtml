
@{
    ViewData["Title"] = "FirstAjax";
}

<h1>FirstAjax</h1>
<input type="text" class="form-control" id="inputName" placeholder="請輸入姓名" />
<input type="number" class="form-control" id="inputAge" placeholder="請輸入年紀" />
<button type="button" class="btn btn-primary mb-3" id="buttonStart">Ajax Start</button>
<div id="div1" class="alert alert-secondary"></div>

@section Scripts{
    <script>
        const btnStart = document.querySelector('#buttonStart');
        const divInfo = document.querySelector('#div1');
        const txtName = document.querySelector("#inputName");
        const txtAge = document.querySelector("#inputAge");

        btnStart.addEventListener("click", () => {      //一定要小寫
            //步驟一建立Ajax物件
            const xhr = new XMLHttpRequest();
            //步驟三在load事件中接收資料
            //當伺服器回傳結果完成後就會觸發load事件
            xhr.addEventListener("load", () => {
                //資料接收
                const data = xhr.responseText;
                //顯示資料
                divInfo.innerHTML = `<h2>${data}</h2>`;
            })
            //步驟二對伺服器端發出要求(Request)
            //xhr.open("GET", "/api/index?name=Mary"); //就像是開啟瀏覽器輸入網址，在後面加上?=....
            xhr.open("GET", `/api/index?name=${txtName.value}&age=${txtAge.value}`);
            xhr.send(); //按下Enter鍵才會真的去執行


        })
    </script>
}
